- **Student(Sno, Sname, Age, Dept)**
- **Course(Cno, Cname, Credit)**
- **SC(Sno, Cno, Grade)**



### 1）单表查询

```sql
-- 查询计算机系的学生
SELECT Sno, Sname
FROM Student
WHERE Dept = 'CS';
```

------

### 2）多表查询

```sql
-- 查询学生姓名及其所选课程名
SELECT S.Sname, C.Cname
FROM Student S
JOIN SC ON S.Sno = SC.Sno
JOIN Course C ON SC.Cno = C.Cno;

SELECT S.Sname, C.Cname
FROM Student S, SC, Course C
WHERE S.Sno = SC.Sno
  AND SC.Cno = C.Cno;

```

------

### 3）带函数表达式的查询

```sql
-- 查询每个学生的年龄加1
SELECT Sname, Age + 1 AS NextAge
FROM Student;
```

------

### 4）相关子查询

```sql
-- 查询成绩高于该课程平均成绩的学生
SELECT Sno, Cno, Grade
FROM SC AS S1
WHERE Grade > (
    SELECT AVG(Grade)
    FROM SC AS S2
    WHERE S2.Cno = S1.Cno
);

SELECT *
FROM SC S1
WHERE GRADE > (
	SELECT AVG(GARDE)
    FROM SC S2
    WHERE S1.Cno = S2.Cno
);
```

------

### 5）不相关子查询

```sql
-- 查询选修了“数据库”课程的学生
SELECT Sno, Sname
FROM Student
WHERE Sno IN (
    SELECT Sno
    FROM SC
    WHERE Cno = (
        SELECT Cno 
        FROM Course 
        WHERE Cname = '数据库'
    )
);

Studen -> SC -> Course
Sname <- Sno <- Cno <- Cname = 'db')
SELECT Sno, Sname
FROM Student
Where Sno IN (
	SELECT Sno
    FROM SC
    WHERE Cno = (
    	SELECT Cno
        FROM Course
        WHERE Cname = 'db'
    )
);

```

------

### 6）集函数查询

```sql
-- 查询每门课程的平均成绩
SELECT Cno, AVG(Grade) AS AvgGrade
FROM SC
GROUP BY Cno;


```

------

### 7）表达“全部”语义的查询

（查询**选修了全部课程的学生**）

```sql
SELECT Sno, Sname
FROM Student S
WHERE NOT EXISTS (
    SELECT *
    FROM Course C
    WHERE NOT EXISTS (
        SELECT *
        FROM SC
        WHERE SC.Sno = S.Sno AND SC.Cno = C.Cno
    )
);
```

------

### 8）表达“至少”语义的查询

（查询**至少选修了小明同学选修的全部课程的学生**）

```sql
SELECT S2.Sno, S2.Sname
FROM Student S2
WHERE NOT EXISTS (
    SELECT *
    FROM SC SC1
    WHERE SC1.Sno = (
        SELECT Sno FROM Student WHERE Sname = '小明'
    )
    AND NOT EXISTS (
        SELECT *
        FROM SC SC2
        WHERE SC2.Sno = S2.Sno
          AND SC2.Cno = SC1.Cno
    )
);
```

------

### 9）带 EXISTS 的子查询

```sql
-- 查询至少选修了一门课程的学生
SELECT Sno, Sname
FROM Student S
WHERE EXISTS (
    SELECT *
    FROM SC
    WHERE SC.Sno = S.Sno
);
```

------

### 10）使用子查询进行批量插入 / 删除 / 修改

**插入**

```sql
-- 将计算机系学生插入到新表 CS_Student
INSERT INTO CS_Student(Sno, Sname)
SELECT Sno, Sname
FROM Student
WHERE Dept = 'CS';
```

**删除**

```sql
-- 删除没有选课的学生
DELETE FROM Student
WHERE Sno NOT IN (
    SELECT Sno FROM SC
);
```

**修改**

```sql
-- 将数据库课程的成绩全部加5分
UPDATE SC
SET Grade = Grade + 5
WHERE Cno = (
    SELECT Cno FROM Course WHERE Cname = '数据库'
);
```

------

### 11）外连接查询

```sql
-- 查询所有学生及其选课情况（包括未选课的学生）
SELECT S.Sno, S.Sname, C.Cname
FROM Student S
LEFT JOIN SC ON S.Sno = SC.Sno
LEFT JOIN Course C ON SC.Cno = C.Cno;
```









```c
"ylqq]aycqyp{"-"{nss_c{es{r}"
gets(&v2);
v4 = strlen(&v2);
for (v5 = 0; v5 < v4; v5 += 1)
{
    //a b || A B -> y z || Y Z
    if ((&v2)[v5] > 96 && (&v2)[v5] <= 98 || (&v2)[v5] > 64 && (&v2)[v5] <= 66)
        (&v2)[v5] = (&v2)[v5] + 24;
    //other -> -2
    else
        (&v2)[v5] = (&v2)[v5] - 2;
}
v3 = strcmp(&v2, &v0);
if (v3)
    printf(&g_404024);
else
    printf(&g_404011);
```

